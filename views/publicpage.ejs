<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title><%= biz.publicTitle || (biz.name + ' — Poster') %></title>

  <style>
    :root {
      --bg: <%= biz.brandColor ? biz.brandColor : '#FFD21E' %>;
      --ink: #0A0A0A; 
      --ink-soft: #2B2B2B;
      --paper: #FFFBEA; 
      --accent: #111; 
      --muted: #4a4a4a;
    }

    @page { margin: 0.5in; } /* shared margin */
    html,body { height:100%; }
    body {
      margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
      background: var(--bg); color: var(--ink);
      display:flex; align-items:center; justify-content:center; padding:24px;
      -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
    }

    /* page size classes */
    body.letter { width: 8.5in; height: 11in; }
    body.a4 { width: 210mm; height: 297mm; }

    .poster {
      width: min(820px, 92vw);
      background: var(--bg);
      border-radius: 24px; 
      box-shadow: 0 10px 24px rgba(0,0,0,.15);
      border: 6px solid var(--ink);
      padding: clamp(18px, 3vw, 32px);
    }

    .header { text-align:center; margin-bottom:20px; }
    .logo {
      width:120px; height:120px; border-radius: 20px; border:4px solid var(--ink);
      background: var(--paper); margin:0 auto 12px;
      display:flex; align-items:center; justify-content:center; overflow:hidden; font-weight:800;
    }
    .logo img { width:100%; height:100%; object-fit:contain; }
    .bizname { margin:0; font-size: clamp(28px, 4.6vw, 46px); font-weight:900; text-transform:uppercase; }

    .cta {
      margin:12px 0; font-weight:900; text-transform:uppercase;
      font-size: clamp(30px, 6vw, 56px);
      letter-spacing: 0.8px; text-align:center;
    }

    .steps {
      list-style:none; padding:0; margin:20px auto; max-width:600px;
      font-size: clamp(16px, 2.6vw, 20px); font-weight:700;
      display:grid; gap:10px;
    }
    .steps li { display:grid; grid-template-columns: 30px 1fr; align-items:center; gap:10px; }
    .steps .num {
      width:30px; height:30px; border:3px solid var(--ink); background:var(--paper); border-radius:8px;
      display:grid; place-items:center; font-weight:900;
    }

    .qr-grid {
      display:grid; gap:18px; grid-template-columns: repeat(3, 1fr);
      margin-top: 24px;
    }
    @media (max-width: 820px){
      .qr-grid{ grid-template-columns: 1fr; }
    }

    .qr-card {
      background: var(--paper); border:4px solid var(--ink); border-radius:18px; padding:14px;
      display:grid; gap:10px; box-shadow: inset 0 -6px rgba(0,0,0,.05);
    }
    .qr-head { display:flex; align-items:center; gap:10px; justify-content:center; }
    .qr-ico { width:28px; height:28px; display:inline-grid; place-items:center; border:3px solid var(--ink); border-radius:8px; background:#fff; font-size:16px; font-weight:900; }
    .qr-title { font-weight:900; text-transform:uppercase; letter-spacing:.4px; text-align:center; }
    .qr-img {
      aspect-ratio: 1 / 1; width:100%; border:3px solid var(--ink); border-radius:12px; background:#fff;
      display:grid; place-items:center; overflow:hidden;
    }
    .qr-img img { width:100%; height:100%; object-fit:cover; }

    .fineprint { margin-top: 20px; text-align:center; font-size:12px; color:var(--muted); font-weight:600; }

    @media print {
      body { background:#fff !important; color:#000; }
    }
  </style>
</head>

<body class="<%= biz.pageSize === 'Letter' ? 'letter' : 'a4' %>">
  <main class="poster">
    <!-- HEADER: Centered Logo + Business Name -->
    <div class="header">
      <div class="logo">
        <% if (biz.showLogo && biz.logoUrl) { %>
          <img src="<%= biz.logoUrl %>" alt="<%= biz.name %> logo" />
        <% } else { %>
          <div><%= (biz.name || 'Your Logo').split(' ').slice(0,2).join('<br>') %></div>
        <% } %>
      </div>
      <h1 class="bizname"><%= biz.name %></h1>
    </div>

    <!-- CTA -->
    <h2 class="cta">
      <%= biz.ctaText || 'Every Scan Wins — Some Unlock a Golden Ticket 🎟️' %>
    </h2>

    <!-- Steps -->
    <ol class="steps">
      <% if (biz.steps && biz.steps.length) {
           biz.steps.sort((a,b)=>a.order-b.order).forEach((s,i)=>{ %>
        <li><span class="num"><%= i+1 %></span><span><%= s.text %></span></li>
      <% }) } else { %>
        <li><span class="num">1</span><span>Scan a QR below to open our latest post.</span></li>
        <li><span class="num">2</span><span>Engage with us → comment, share, or upload a photo and tag us.</span></li>
        <li><span class="num">3</span><span>Check your screen → you’ll always get our offer, and sometimes a Golden Ticket surprise!</span></li>
        <li><span class="num">4</span><span>Show your screen at the counter to redeem your perk.</span></li>
      <% } %>
    </ol>

    <!-- QR GRID (only shows enabled platforms) -->
    <section class="qr-grid">
      <% if (biz.tiktokUrl) { %>
        <article class="qr-card">
          <div class="qr-head">
            <div class="qr-ico">♪</div>
            <div class="qr-title">TikTok</div>
          </div>
          <div class="qr-img">
            <img alt="TikTok QR" src="/qr/<%= biz.slug %>/tiktok.png" />
          </div>
        </article>
      <% } %>

      <% if (biz.instagramUrl) { %>
        <article class="qr-card">
          <div class="qr-head">
            <div class="qr-ico">IG</div>
            <div class="qr-title">Instagram</div>
          </div>
          <div class="qr-img">
            <img alt="Instagram QR" src="/qr/<%= biz.slug %>/instagram.png" />
          </div>
        </article>
      <% } %>

      <% if (biz.youtubeUrl) { %>
        <article class="qr-card">
          <div class="qr-head">
            <div class="qr-ico">▶</div>
            <div class="qr-title">YouTube Shorts</div>
          </div>
          <div class="qr-img">
            <img alt="YouTube QR" src="/qr/<%= biz.slug %>/youtube.png" />
          </div>
        </article>
      <% } %>
    </section>

    <!-- Footer -->
    <p class="fineprint">
      <%= (biz.publicFooter && biz.publicFooter.trim().length)
            ? biz.publicFooter
            : 'Perks tied to follows/check-ins. Feedback appreciated, never required.' %>
    </p>
  </main>
</body>
</html>
