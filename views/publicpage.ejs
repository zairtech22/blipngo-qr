<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title><%= biz.publicTitle || (biz.name + ' â€” Poster') %></title>

  <style>
    :root{
      --bg: <%= biz.brandColor || '#FFD21E' %>;
      --ink:#0A0A0A; --ink-soft:#2B2B2B;
      --paper:#FFFBEA; --accent:#111; --muted:#4a4a4a;
    }

    @page { size: 8.5in 11in; margin: 0.5in; }
    html,body{ height:100%; }
    body{
      margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
      background: var(--bg); color: var(--ink);
      display:flex; align-items:center; justify-content:center; padding:24px;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }
    .poster{
      width: min(820px, 92vw);
      background: var(--bg);
      border-radius: 24px; box-shadow: 0 10px 24px rgba(0,0,0,.15);
      border: 6px solid var(--ink);
      padding: clamp(18px, 3vw, 32px);
    }
    .row{ display:grid; gap: 18px; }
    .brand{ display:grid; grid-template-columns: 96px 1fr; gap:16px; align-items:center; }
    .logo{
      width:96px; height:96px; border-radius: 20px; border:4px solid var(--ink);
      background: var(--paper); display:grid; place-items:center; font-weight:800;
      letter-spacing:.5px; text-align:center; padding:6px; line-height:1.1; overflow:hidden;
    }
    .logo img{ width:100%; height:100%; object-fit:contain; }
    .bizname{ margin:0; font-size: clamp(28px, 4.6vw, 46px); line-height:1.05; text-transform:uppercase; }

    .badge{
      display:inline-block; border:4px solid var(--ink); background: var(--paper);
      padding:6px 12px; border-radius:999px; font-weight:800; margin-top:8px;
    }

    .cta{
      margin:6px 0 0; font-weight:900; text-transform:uppercase;
      font-size: clamp(30px, 6vw, 56px);
      letter-spacing: 0.8px;
    }
    .cta small{ display:block; font-size: clamp(16px, 2.4vw, 18px); font-weight:700; color:var(--ink-soft); text-transform:none; }

    .steps{
      list-style:none; padding:0; margin:14px 0 8px; display:grid; gap:10px;
      font-size: clamp(16px, 2.6vw, 20px); font-weight:700;
    }
    .steps li{ display:grid; grid-template-columns: 30px 1fr; align-items:center; gap:10px; }
    .steps .num{
      width:30px; height:30px; border:3px solid var(--ink); background:var(--paper); border-radius:8px;
      display:grid; place-items:center; font-weight:900;
    }

    .qr-grid{
      display:grid; gap:18px; grid-template-columns: repeat(3, 1fr);
      margin-top: 12px;
    }
    @media (max-width: 820px){
      .qr-grid{ grid-template-columns: 1fr; }
      .brand{ grid-template-columns: 72px 1fr; }
      .logo{ width:72px; height:72px; }
    }

    .qr-card{
      background: var(--paper); border:4px solid var(--ink); border-radius:18px; padding:14px;
      display:grid; grid-template-rows: auto 1fr auto; gap:10px; box-shadow: inset 0 -6px rgba(0,0,0,.05);
    }
    .qr-head{ display:flex; align-items:center; gap:10px; }
    .qr-ico{ width:28px; height:28px; display:inline-grid; place-items:center; border:3px solid var(--ink); border-radius:8px; background:#fff; font-size:16px; font-weight:900; }
    .qr-title{ font-weight:900; text-transform:uppercase; letter-spacing:.4px; }
    .qr-img{
      aspect-ratio: 1 / 1; width:100%; border:3px solid var(--ink); border-radius:12px; background:#fff;
      display:grid; place-items:center; overflow:hidden;
    }
    .qr-img img{ width:100%; height:100%; object-fit:cover; }
    .qr-caption{ text-align:center; font-size:14px; color:var(--muted); font-weight:700; word-break: break-word; }

    .fineprint{ margin-top: 10px; font-size:12px; color:var(--muted); font-weight:600; }

    @media print {
      body { background:#fff !important; color:#000; }
    }
  </style>
</head>

<body>
  <main class="poster">
    <!-- BRAND HEADER -->
    <section class="row brand">
      <div class="logo">
        <% if (biz.showLogo && biz.logoUrl) { %>
          <img src="<%= biz.logoUrl %>" alt="<%= biz.name %> logo" />
        <% } else { %>
          <div><%= (biz.name || 'Your Logo').split(' ').slice(0,2).join('<br>') %></div>
        <% } %>
      </div>
      <div>
        <h1 class="bizname"><%= biz.name %></h1>
        <div class="badge">SCAN â€¢ FOLLOW â€¢ SHOW â€¢ REDEEM</div>
      </div>
    </section>

    <!-- CTA / OFFER -->
    <section class="row">
      <h2 class="cta">
        <%= biz.ctaText || 'GET A FREE DRINK!' %>
        <small>
          <%= (biz.publicSubtitle && biz.publicSubtitle.trim().length)
                ? biz.publicSubtitle
                : 'Fun perk for our community â€” no review required. ðŸ’›' %>
        </small>
      </h2>
      <ol class="steps">
        <% if (biz.steps && biz.steps.length) {
             biz.steps.sort((a,b)=>a.order-b.order).forEach((s,i)=>{ %>
          <li><span class="num"><%= i+1 %></span><span><%= s.text %></span></li>
        <% }) } else { %>
          <li><span class="num">1</span><span>Scan any QR below and open the app.</span></li>
          <li><span class="num">2</span><span>Follow us and say hi in a comment or DM.</span></li>
          <li><span class="num">3</span><span>Optional: Share feedback on Google â€” totally up to you.</span></li>
          <li><span class="num">4</span><span>Show the screen at the counter to redeem your perk.</span></li>
        <% } %>
      </ol>
    </section>

    <!-- QR GRID (shows only enabled platforms) -->
    <section class="qr-grid">
      <% if (biz.tiktokUrl) { %>
        <article class="qr-card">
          <div class="qr-head">
            <div class="qr-ico">â™ª</div>
            <div class="qr-title">TikTok</div>
          </div>
          <div class="qr-img">
            <img alt="TikTok QR" src="/qr/<%= biz.slug %>/tiktok.png" />
          </div>
          <div class="qr-caption"><%= biz.tiktokUrl %></div>
        </article>
      <% } %>

      <% if (biz.instagramUrl) { %>
        <article class="qr-card">
          <div class="qr-head">
            <div class="qr-ico">IG</div>
            <div class="qr-title">Instagram</div>
          </div>
          <div class="qr-img">
            <img alt="Instagram QR" src="/qr/<%= biz.slug %>/instagram.png" />
          </div>
          <div class="qr-caption"><%= biz.instagramUrl %></div>
        </article>
      <% } %>

      <% if (biz.youtubeUrl) { %>
        <article class="qr-card">
          <div class="qr-head">
            <div class="qr-ico">â–¶</div>
            <div class="qr-title">YouTube Shorts</div>
          </div>
          <div class="qr-img">
            <img alt="YouTube QR" src="/qr/<%= biz.slug %>/youtube.png" />
          </div>
          <div class="qr-caption"><%= biz.youtubeUrl %></div>
        </article>
      <% } %>
    </section>

    <p class="fineprint">
      <%= (biz.publicFooter && biz.publicFooter.trim().length)
            ? biz.publicFooter
            : 'Perks tied to follows/check-ins. Feedback appreciated, never required.' %>
    </p>
  </main>
</body>
</html>
